<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html> <head>
<title>debug_print.cについて</title>
</head>

<body>

<h1>debug_print.cについて</h1>

<h2>debug_print.cとは</h2>

  <p>debug_print.cは、<b>VCE-AdminToolに対応するためのスケルトンコードです。</b><br>
  従来、これらに対応するためには毎回同じようなコードを書く必要がありましたが、
  その手間を軽減することができます。<br>
  また、VCE-AdminToolに対応したLogを出力することは、ドキュメント不足などにより
  よく分からないことが多いと思うので、それに対する救済措置でもあります。<br>


  <p>デメリットは、カスタマイズの自由度が減ることですがライブラリではなくスケルトンコードと
  することでそれもなるべく軽減しています。<br>
  (それによって、カスタマイズ後のdebug_print.cバージョンアップなどはできないが…)

<h2>debug_print.cによって実現される機能</h2>

  <p>以下の機能がdebug_print.cによって追加されます。
  
  <ul>
    <li>VCE-Monitorの初期化
    <li>VCE-Monitorに基本的なモニターコマンド(get_name, get_login, shutdown, 
        その他VCE-Log用コマンド)の追加
    <li><b>VCE-Logに対応したログの出力</b>(printd関数)
    <li><b>ログのVCE-AdminToold(rsv)</b>への転送
  </ul>

<h2>debug_print.cの使い方</h2>

  <em>具体的には、サンプルを参照してください。</em>

  <p>導入手順：

  <ol>
    <li>debug_print.c, debug_print.h をソースのディレクトリにコピーする。
    <li>debug_print.c の <b>CUSTOMIZE HERE</b>と書かれた部分を
        各アプリケーションごとにカスタマイズする。<br>
        詳しくは、debug_print.cのコメントの中を参照してください
    <li>VCEの初期化が済んだ後に、init_monitor(), init_log()の呼び出しを記述する
    <li>printd()を使用するファイルに対して、debug_print.hをincludeする
  </ol>

  以上で、printd()によるログの出力が可能になります。

  <p>printd()は、以下のように使用して下さい。

  <p>printd( <em>ログの種類(_ERROR, _LOG など )</em>, 
             <em>フォーマット文字列</em> 
             [ , ...<em>可変引数リスト</em> ] );<br>
  例：printd( _ERROR, "file error( %d )", err );


<h2>ログの種類について</h2>

  <p>ログの種類は、debug_print.h内の"_"で始まるマクロで定義されています。<br>
  これは各アプリケーションごとにカスタマイズすることが可能です。
  カスタマイズする場合は、init_log()内のログの種類を追加するコードを書き足してください。

  <p><b>ログの種類は、サービスのセキュリティポリシー、運用ポリシーなどによって、
     適切に設計される必要があります。</b>
     ユーザーのパスワードなどをログに出す場合は、そのログを見れる人間を制限する必要があるでしょう。
  
  <p>デフォルトで用意されているログの種類については、下を参照してください。

  <dl>
    <dt>_LOG
    <dd>もっとも細かいレベルのログです。<br>
        デバッグレベルでは使用されるが、普段の運用時には出力しないものです。
    <dt>_INFO
    <dd>運用時に出力されるものの中では、最も細かいレベルのログです。
    <dt>_WARN
    <dd>開発者、運用者にチェックされるべきレベルのログです。<br>
        バグではないがバグに近い場所や、サーバーの実行に支障はないが、
        本当は通ってはいけない場所などに記述します。<br>
        運用時に、このレベルのログは開発者に伝わるようにします。
    <dt>_ERROR
    <dd>回復可能なのエラーのログです。エラー処理ルーチンなどに記述します。<br>
        回復するロジックが組み込まれているため、開発者にとっては_WARNよりも重要性は低いことになります。
    <dt>_FATAL
    <dd>回復不能なレベルのエラーのログです。<br>
        もっとも重要性が高いログになります。<br>
        運用時に、このレベルのログは開発者に伝わるようにします
        
    <dt>_GM
    <dd>ゲームマスター向けのログです。
    <dt>_ADMIN
    <dd>ゲームサーバー管理者(もしくは、上級ゲームマスターなど)むけのログです。
  </dl>


<br>
<br>
<br>
<hr>
<font size=-1>
Copyright 2000-2005 CommunityEngine Inc. All rights reserved.<BR>
  
</body>
</html>
