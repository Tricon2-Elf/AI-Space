<?xml version="1.0" ?>
<!DOCTYPE html 
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>footer.rd</title>
<link href="stylesheet.css" type="text/css" rel="stylesheet" />
</head>
<body>
<h1><a name="label-0" id="label-0">デモプログラムについて</a></h1><!-- RDLabel: "デモプログラムについて" -->
<p>lobby-suiteには，linux/win32/PlayeStation2 で動作するクライアントプログラムが附属しています。
このクライアントプログラムには，lobbyサーバーとのやりとりの部分と，
peer to peer のゲームのモードの2種類が存在します。</p>
<h2><a name="label-1" id="label-1">lobbyモード</a></h2><!-- RDLabel: "lobbyモード" -->
<p>lobbyモードでは，簡単なコマンド選択方式で動作します。
lobbyモードの画面はメッセージウィンドウ，コマンドウィンドウ，入力ウィンドウに別れています。
各コマンドが画面右に並んでいるので，カーソルを操作し，必要ならばパラメータを入力し，
決定するとサーバーにコマンドが送信され，結果を受信するとその結果を画面に出力します。</p>
<h3><a name="label-2" id="label-2">lobbyモードの主な流れ</a></h3><!-- RDLabel: "lobbyモードの主な流れ" -->
<p>ユーザーが一般的に行うと思われる行動順は以下のようになっています。</p>
<pre>Client   →   Server

Connect
Ping
Auth
(CreateCharacter)
(Load_Contact)
(Mail_poll)
Login
(CreateChannel)
Open
(talk)
(CreateRoom)
EnterRoom
(talk)
GameStart
GameEnd
Logout
Disconnect</pre>
<p>各コマンドに対してどのような返答が返ってくるかは，
lobbysuite/proto/lobbyproto.txt
を参考にしてください。</p>
<h3><a name="label-3" id="label-3">lobbyモードでのコマンド一覧</a></h3><!-- RDLabel: "lobbyモードでのコマンド一覧" -->
<p>クライアントで行えるコマンドは現在は以下の通りです。</p>
<ul>
<li>Connect (サーバーに接続)</li>
<li>Disconect (サーバーから切断)</li>
<li>CrChan (チャンネルの作成)</li>
<li>DelChan (チャンネルの削除)</li>
<li>SvList (サーバーリスト取得)</li>
<li>Open (チャンネルのオープン)</li>
<li>List (キャラクターリストの取得)</li>
<li>Login (キャラクターログイン)</li>
<li>CrChar (キャラクター作成)</li>
<li>DelChar (キャラクター削除)</li>
<li>Ping (ping送信)</li>
<li>Message ( メッセージ送信)</li>
<li>Mail (メール送信)</li>
<li>PollMail (メール受信)</li>
<li>EnterRoom (部屋入室)</li>
<li>ListRoom (部屋一覧)</li>
<li>CrRoom ( 部屋の作成)</li>
<li>DelRoom (部屋の削除)</li>
<li>ExitRoom (退室)</li>
<li>GameStart (ゲーム開始)</li>
<li>GameEnd (ゲーム終了)</li>
<li>NewStatus (コンタクトリストのメンバーに状態送信)</li>
<li>LoadContact (コンタクトリストのロード)</li>
<li>SaveContact (コンタクトリストのセーブ)</li>
<li>UserId (サーバーに送信するユーザーID変更)</li>
<li>Password (サーバーに送信するパスワード変更)</li>
<li>Cdkey (サーバーに送信するCDKEY変更)</li>
</ul>
<h2><a name="label-4" id="label-4">ゲームモード(対戦ゲーム)</a></h2><!-- RDLabel: "ゲームモード(対戦ゲーム)" -->
<p>殺しあいゲームです。 ユーザは常に画面の真中にいるキャラクターを操作し、
限られた視界を持ちます。ユーザは○ボタンを押すとヨーヨー
を飛ばします。ヨーヨーを何回か当てられると死にます。死んだかどうかの判定は、
ヨーヨーを投げているほうのプレイヤーが実行します。</p>
<h3><a name="label-5" id="label-5">親と子</a></h3><!-- RDLabel: "親と子" -->
<p>このゲームモードでは，クライアント間でコネクションを張り，サーバークライアント型の通信を行います。
lobbyサーバーとのサーバーと勘違いしないように，lobby-suiteでの対戦ゲームのクライアント同士の
サーバー，クライアントの関係を「親」と「子」と呼びます。</p>
<h3><a name="label-6" id="label-6">ゲーム開始までの動き</a></h3><!-- RDLabel: "ゲーム開始までの動き" -->
<p>ゲームを開始するには，lobbyモードで部屋に入室し，そこでallow_start_gameプロトコルを送信する事によって，
親となるべきクライアントを決定し，そのクライアントが親となるべき処理を実行後，
start_game_readyプロトコルをサーバーに送信します。
そうするとサーバーからstart_game_pasvプロトコルが送信され，接続すべき，されるべき各ユーザーのIPアドレスと，キャラクターのIPアドレスが送信されます。</p>
<p>親プログラムでは，今後接続してくるすべてのクライアントのIPアドレス
を登録します。クライアントでは、接続先となるサーバのIPアドレスを登録します。
サーバはクライアントからの接続があるとマップのデータを送ります。
サーバは、接続を待っているすべてのIPアドレスからの接続が完了すると、
ゲーム開始の信号を送ります。</p>
<h3><a name="label-7" id="label-7">移動についてのアルゴリズム</a></h3><!-- RDLabel: "移動についてのアルゴリズム" -->
<p>各プレイヤーは自分が移動するたびに、サーバに自分の位置情報を教えます。
サーバはその情報を受けとると、各プレイヤーに、新しく移動した位置情報を
送信します。 この構造は、移動だけでなくほかの行動に関しても同様です。</p>
<pre>written by Masahiro Kawata(河田 正広)
mas@vce-lab.net
CommunityEngine Inc.
2001</pre>

</body>
</html>
